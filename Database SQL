/*Write code in MySQL. For each day of a time period, 
find the total number of unique users who made at least 1 transaction each day 
from the beginning of the time period to that day, find the user id and user name who 
made maximum number of transactions each day. If more than one such user has a maximum number of transactions, 
select the lowest user id. The query printed the information for each day of the time period, sorted by date.*/

/*MySQL*/
/*
Enter your query here.
*/
select t5.b4_b2_submission_date, t4.t3_count, t5.min_b4_b2_hacker_id, Hackers.name
from Hackers

inner join 

(select b4.b2_submission_date as b4_b2_submission_date, b4.b2_count_submission_id as b4_b2_count_submission_id, min(b4.b2_hacker_id) as min_b4_b2_hacker_id
from
(select b2.submission_date as b2_submission_date, b2.hacker_id as b2_hacker_id, b2.count_submission_id as b2_count_submission_id
from
(select submission_date, hacker_id, count(submission_id) as count_submission_id
from Submissions 
group by submission_date, hacker_id) as b2
inner join
(select b1.submission_date as b1_submission_date, max(b1.count_hacker_id) as max_b1_count_hacker_id
from
(select submission_date, hacker_id, count(submission_id) as count_hacker_id
 from Submissions 
 group by submission_date, hacker_id ) as b1
 group by b1.submission_date) as b3
 on b2.submission_date=b3.b1_submission_date and b2.count_submission_id=b3.max_b1_count_hacker_id
) as b4
group by b4.b2_submission_date, b4.b2_count_submission_id) as t5

on Hackers.hacker_id = t5.min_b4_b2_hacker_id

inner join

(select t3.t2_submission_date as t3_submission_date, count(t3.count_t2_hacker_id) as t3_count
from
(select t2.submission_date as t2_submission_date, t2.hacker_id as t2_hacker_id, count(t2.hacker_id) as count_t2_hacker_id
from
(select distinct submission_date, hacker_id from Submissions) as t1
inner join
(select distinct submission_date, hacker_id from Submissions) as t2
on t1.submission_date <=t2.submission_date
and t1.hacker_id = t2.hacker_id
group by t2.submission_date, t2.hacker_id
having (t2.submission_date="2016-03-01" and count(t2.hacker_id)=1) or 
      (t2.submission_date="2016-03-02" and count(t2.hacker_id)=2) or
      (t2.submission_date="2016-03-03" and count(t2.hacker_id)=3) or
      (t2.submission_date="2016-03-04" and count(t2.hacker_id)=4) or
      (t2.submission_date="2016-03-05" and count(t2.hacker_id)=5) or
      (t2.submission_date="2016-03-06" and count(t2.hacker_id)=6) or
      (t2.submission_date="2016-03-07" and count(t2.hacker_id)=7) or
      (t2.submission_date="2016-03-08" and count(t2.hacker_id)=8) or
      (t2.submission_date="2016-03-09" and count(t2.hacker_id)=9) or
      (t2.submission_date="2016-03-10" and count(t2.hacker_id)=10) or
      (t2.submission_date="2016-03-11" and count(t2.hacker_id)=11) or
      (t2.submission_date="2016-03-12" and count(t2.hacker_id)=12) or
      (t2.submission_date="2016-03-13" and count(t2.hacker_id)=13) or
      (t2.submission_date="2016-03-14" and count(t2.hacker_id)=14) or
      (t2.submission_date="2016-03-15" and count(t2.hacker_id)=15)) as t3

group by t3.t2_submission_date
) as t4
on t5.b4_b2_submission_date = t4.t3_submission_date
order by t5.b4_b2_submission_date
